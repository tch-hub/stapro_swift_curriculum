# lib フォルダ整理計画

## 目的

- `src/lib` を SvelteKit アプリから共通で使う UI、ロジック、データ置き場として明確にし、今後の機能追加やライブラリ化に耐える構造にリファクタリングする。
- 各サブディレクトリの役割を明文化し、新しいファイルや機能を追加するときに迷わないようナビゲーションガイドを設ける。

## 現行構成と役割

| フォルダ/ファイル | 説明                                                                                                     |
| ----------------- | -------------------------------------------------------------------------------------------------------- |
| `assets/`         | `src/lib` で使う画像や静的ファイル。`static/` との棲み分けを明確にする必要がある。                       |
| `components/`     | 共通 UI コンポーネント。`projects/` のような機能別サブディレクトリが混在しているため整理余地あり。       |
| `composables/`    | `useSearch.svelte.js` のような再利用ロジック。命名規則とエクスポート戦略を明らかにする。                 |
| `config/`         | 設定値。現状は空だが、スキーマや型をここに置く想定。                                                     |
| `data/`           | チートシートやクイズなどの静的 JSON。フォルダが深くなっていて、意味別に整理したほうが可読性が上がる。    |
| `index.js`        | `$lib` 経由でエクスポートするトップレベル。今は `CodeBlock` のみ。                                       |
| `services/`       | `search.ts` など外部 API や汎用処理。今後増える想定なので層を定義しておきたい。                          |
| `state/`          | グローバル状態管理用スクリプト。現状空だが、動的ステートを置く想定。                                     |
| `steps/`          | タイマーや TODO チュートリアルなどステップ系。フォルダ単位で粒度が大きく、再利用ポイントの抽出が難しい。 |

## 整理指針

1. 目的別のサブフォルダを明確化し、名付けは「機能名+役割」 (例: `components/ui/`, `data/quiz/`) で統一する。
2. `assets/` は `static` に置けないビルド時生成素材に限定し、画像やアイコンは `static/` か `src/lib/assets/ui/` に分ける。
3. `index.js` に `CodeBlock` 以外のエクスポートも明示し、`src/lib/components` 下の命名基準をまとめて README を作る。
4. コード・資料ともに英語/日本語どちらも扱えるようにコメントや見出しを含めて整理する。

## 再構成案

### `components`

- `ui/`: ボタン・カード・検索バーなど汎用 UI。DaisyUI や独自スタイルで使うパーツを集約。
- `feature/`: `TimerDemo` や `ToDoListDemo` など特定機能に依存するコンポーネント。必要に応じて `projects/` を `feature/projects/` に移動。
- 各コンポーネントに `README` で使い方例をまとめ、`+page` からの流用例を併記する。

### `composables`

- `useSearch` のような再利用フックを `hooks/` 風に整理し、ファイル名は `useXxx.js` で統一。
- 今後リアクティブストアを追加する場合は `useStore/` だけでなく `stores/` に分ける案も合わせて検討。

### `data`

- `cheatsheet/`, `quiz/`, `tutorial/`, `projects/` といった用途別ディレクトリに分割。
- ファイル命名には機能を含める (`timer-cheatsheet.json` など)。
- JSON のスキーマは `data/schema-*.md` で定義し、Svelte コンポーネント側から `type` を明示できるようにする。

### `services`, `state`

- `services/` は API 呼び出し・検索エンジン・ユーティリティ関数。`search.ts` を `services/search/index.ts` に拡張し、テストとドキュメントを同梱。
- `state/` は Svelte ストアや `Writable` をまとめる。`steps` と連携するステップ状態はここから提供するコンポーネントを経由する。

### `steps`

- 各チュートリアルを `steps/tutorials/<name>` にし、共通ロジック（フェーズ定義など）を `steps/common/` に移す。
- `timer/`, `todolist/` にある `+page` から必要なデータを `data/` からインジェクトする流れをドキュメント化。

### `assets`

- ビルドプロセスでのみ使う画像・フォントを `lib/assets/`、一般画像は `static/images/` に分離。
- ファイル命名規則（`ui-`, `tutorial-` など）を決め、過去の `TimerDemo` で使っていた画像も整理。

## 実施ステップ

1. 本ドキュメントをもとに `docs/lib-organization.md` をリポジトリの参照地点とする。
2. `components/`・`data/`・`steps/` の旧ファイルを新構成に移動し、それぞれ `README` や `index.ts` で役割を説明。
3. `src/lib/index.js` を拡張し、今後 `$lib` から共通モジュールをインポートできるようにする。
4. `services`・`state`・`assets` に関する補足ガイドを `docs/` 内に追加し、整備後に更新する。

## 期待される成果

- `src/lib` の読みやすさと進化対応力が向上し、新規開発者が参照しやすくなる。
- `components`/`data`/`steps` における命名・配置ルールが定着し、ミスや重複を防止。
- `$lib` アライアス経由で使う際に整理されたトップレベルが参照可能。
